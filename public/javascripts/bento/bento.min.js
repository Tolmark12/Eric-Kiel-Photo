var popstateLoaded=!1;
function moveToPane(a){var b=$('div.view-port-container > div[data-path="'+a+'"]:first');if(b.length>0){window.location.pathname==a||window.location.pathname==a.substring(0,a.indexOf("?"))||history.pushState({},"",a);$(".buttons").hide();$('.buttons > div:not(div[data-path="'+a+'"]:first)').hide();$('.buttons > div[data-path="'+a+'"]:first').nextAll("div").remove();$('.buttons > div[data-path="'+a+'"]:first').show();$(".buttons").fadeIn("slow");var c=$(".view-port-container:first").width();b.prevAll(".view-port-container>div").each(function(a,
b){$(b).animate({marginLeft:"-"+(c-a*1014)+"px"},{easing:"easeInOutQuint",duration:400})});b.animate({marginLeft:"0px"},{easing:"easeInOutQuint",duration:400});b=b.nextAll(".view-port-container>div");$(".view-port-container:first").width(c-1014*(b.length-1));b.remove();$(".bread-crumb ul").hide();$('.bread-crumb ul[data-path="'+a+'"]:first').nextAll("ul").remove();$('.bread-crumb ul[data-path="'+a+'"]:first').show();return!0}else return!1}
function ajaxClick(a){a.match(/\?/g)!=null?jsonLink=a.replace(/\?/g,".json?"):jsonLink=a+".json";windowId=a.substring(0,a.indexOf("?"));if(!moveToPane(a))$('.bread-crumb a[rel="address:'+a+'"] > span').length>0?window.location=a:(history.pushState({},"",a),popstateLoaded||(popstateLoaded=!0,$(window).bind("popstate",function(){if(!moveToPane(location.pathname))window.location=location})),$.get(jsonLink,function(a){$(".buttons").hide();$(".buttons").append("<div data-path='"+windowId+'\'><input type="submit" class="button-thin cancel back" value="Back">'+
(a.toolbar!=null?a.toolbar:"")+"</div>");$(".buttons > div:not(div:last)").hide();var c=a.content,d=$(".view-port-container > div:last");$(".view-port-container:first").width();$(".view-port-container > div");d.after($(c).attr("data-path",windowId));$(".view-port-container > div").width(1005);$(".view-port-container > div:last").css("float","left");$(".buttons > div:last > .back").unbind("click");$(".buttons > div:last > .back").click(function(a){history.back();a.preventDefault();return!1});$(".bread-crumb ul").hide();
$(".bread-crumb ul:last").after($(a.breadcrumb).attr("data-path",windowId));moveToPane(windowId);eval(a.javascript)},"json"));return!1}
function attachEvents(){$(".view-port-container > div").width(1005);$(".selector-wrapper .button").unbind("toggle");$(".selector-wrapper .button").toggle(function(){$(this).addClass("active");$(this).parent().next(".grid-container").show();var a=$(this).children().filter("span");a.removeClass("light");a.addClass("dark");return!1},function(){$(this).removeClass("active");$(this).parent().next(".grid-container").hide();var a=$(this).children().filter("span");a.removeClass("dark");a.addClass("light");
return!1});$('a[rel^="address:"]').unbind("click");$('a[rel^="address:"]').click(function(a){ajaxClick(this.href.replace(/[A-Za-z]+\:\/\/[:.\-\_A-Za-z0-9]+/gi,""));a.preventDefault();return!1});$(".hidden").hide()}$(document).ready(function(){attachEvents();$(this).ajaxStop(function(){attachEvents()})});