jQuery(function(b){var e=b("meta[name=csrf-token]").attr("content"),f=b("meta[name=csrf-param]").attr("content");b.fn.extend({triggerAndReturn:function(a,c){var d=new b.Event(a);this.trigger(d,c);return d.result!==!1},callRemote:function(){var a=this,c=a.attr("method")||a.attr("data-method")||"GET",d=a.attr("action")||a.attr("href"),e=a.attr("data-type")||"script";if(d===void 0)throw"No URL specified for remote call (action or href must be present).";else{if(a.triggerAndReturn("ajax:before")){var f=
a.is("form")?a.serializeArray():[];b.ajax({url:d+".js",data:f,dataType:e,type:c.toUpperCase(),beforeSend:function(b){a.trigger("ajax:loading",b)},success:function(b,c,d){a.trigger("ajax:success",[b,c,d])},complete:function(b){a.trigger("ajax:complete",b)},error:function(b,c,d){a.trigger("ajax:failure",[b,c,d])}})}a.trigger("ajax:after")}}});b("a[data-confirm],input[data-confirm]").live("click",function(a){a.preventDefault();a=b(this);if(a.triggerAndReturn("confirm")&&!confirm(a.attr("data-confirm")))return!1});
b("form[data-remote]").live("submit",function(a){b(this).callRemote();a.preventDefault()});b("a[data-remote],input[data-remote]").live("click",function(a){b(this).callRemote();a.preventDefault()});b("a[data-method]:not([data-remote])").live("click",function(a){var c=b(this),d=c.attr("href"),c=c.attr("data-method"),d=b('<form method="post" action="'+d+'"></form>'),c='<input name="_method" value="'+c+'" type="hidden" />';f!=null&&e!=null&&(c+='<input name="'+f+'" value="'+e+'" type="hidden" />');d.hide().append(c).appendTo("body");
a.preventDefault();d.submit()});var g=function(){b(this).find("input[data-disable-with]").each(function(){var a=b(this);a.data("enable-with",a.val()).attr("value",a.attr("data-disable-with")).attr("disabled","disabled")})};b("form[data-remote]:has(input[data-disable-with])").live("ajax:before",g);b("form:not([data-remote]):has(input[data-disable-with])").live("submit",g);b("form[data-remote]:has(input[data-disable-with])").live("ajax:complete",function(){b(this).find("input[data-disable-with]").each(function(){var a=
b(this);a.removeAttr("disabled").val(a.data("enable-with"))})})});